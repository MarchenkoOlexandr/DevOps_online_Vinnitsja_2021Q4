=== RSS for Yandex Turbo ===
Contributors: Flector
Donate link: http://goo.gl/CcxWYg
Tags: yandex, turbo, yandex turbo, rss, feed
Requires at least: 4.4
Tested up to: 4.9.2
Stable tag: trunk

Создание RSS-ленты для сервиса Яндекс.Турбо.

== Description ==

Данный плагин автоматически создаст на вашем сайте новую RSS-ленту (или несколько лент) для сервиса "Яндекс.Турбо" в полном соответствии с [техническими требованиями](https://yandex.ru/support/webmaster/turbo/feed.html) Яндекса. 

После установки плагина не забудьте проверить его настройки в "Настройках\Яндекс.Турбо".

Чтобы добавить свою ленту в Яндекс.Турбо вам надо будет отправить заявку в Яндекс.Вебмастере ("Информация о сайте\Турбо-страницы").

Если вам понравился этот плагин, то, <strong>пожалуйста</strong>, поставьте ему 5 звезд.
 

Настройки плагина вы найдете в "<strong>Настройках\Яндекс.Турбо</strong>".

== Frequently Asked Questions ==

= Инструкция по установке =

1. Установите плагин из админки движка "<strong>Плагины\Добавить новый</strong>".
2. Активируйте плагин в меню "<strong>Плагины</strong>".
3. Зайдите в настройки плагина "<strong>Настройки\Яндекс.Турбо</strong>" и сохраните их.
4. Это все.

= Лента не проходит валидацию, что делать? =

Лента для Яндекс.Турбо никогда не сможет пройти валидацию, так как технические требования Яндекс.Турбо несовместимы со стандартами обычного RSS. 

= Лента отдается с неправильным content type, что делать? =

Плагин создает ленту с правильным контент типом "application/rss+xml". Если у вас лента отдается с другим контент типом, то весьма вероятно, что в этом виноват ваш плагин кэширования. Добавьте урл ленты в исключения плагина (все плагины кэширования имеют опцию исключения определенных страниц).

= URL источника запрещен в robots.txt, что делать? =

Добавьте в robots.txt директиву:

`Allow: /feed/turbo/`

Где "turbo" это имя вашей RSS-ленты.
Желательно расположить эту директиву выше запретительной (бот Яндекса глючит в данный момент).

= Как добавить "подпись" к записям ленты? =

В плагине есть фильтр "yturbo_the_content" для обработки контента записей.

Пример использования (добавьте этот код в файл functions.php вашей темы):

`function yturbo_sign($content) {
    global $post;
     
    $sign = 'Сообщение "<a href="'.get_permalink($post->ID).'">'.$post->post_title.'</a>" появилось сначала на "<a href="'.get_bloginfo_rss('url').'">'.get_bloginfo_rss('title').'</a>".';
    
    $content .= $sign;
    return $content;
}    
add_filter('yturbo_the_content', 'yturbo_sign');`

И вы получите подпись, аналогичную подписи от плагина Yoast SEO.


== Screenshots ==

1. Пример добавленных RSS-лент в Яндекс.Вебмастере. 
2. Часть настроек плагина с ссылками на RSS-ленты. 
3. Основные настройки плагина. 
4. Настройки рекламы и счетчиков. 
5. Продвинутые настройки. 
6. Метабокс плагина. 

== Changelog ==

= 1.11 =
* переписана функция удаления тегов с контентом (теперь она справляется со вложенностью).
* из контента теперь удаляются лишние изображения (в одном item-элементе может быть только 30 уникальных изображений).

= 1.10 =
* функция iconv_strlen была заменена на функцию mb_strlen (первая выдавала ошибку при плохой разметке записи - в результате отсутствовала реклама в середине записи).

= 1.09 =
* добавлена возможность включения в rss-ленту записей только указанных таксономий.

= 1.08 =
* добавлена возможность установить все поддерживаемые Яндексом счетчики.

= 1.07 =
* добавлена возможность отключения рекламы для конкретной записи (в метабоксе плагина).
* исправлена работа плагина, когда атрибуты тега img указаны в одинарных кавычках вместо двойных.

= 1.06 =
* добавлена опция отключения вывода автора записи (тег &lt;author> для Яндекс.Турбо не является обязательным).
* из контента записей теперь удаляются все спец. символы юникода (как невалидные в rss).
* полностью переписаны регулярки плагина - из тегов img теперь вырезаются все лишние атрибуты.  

= 1.05 =
* я дико извиняюсь за столь частые обновления плагина!
* были оптимизированы регулярки плагина, так как в некоторых случаях мог удаляться контент записи в RSS-ленте.

= 1.04 =
* к контенту записей больше не применяется фильтр "the_content_feed" (во избежание конфликтов с другими плагинами, работающими с RSS).
* добавлен фильтр обработки контента "yturbo_the_content" записи.
* удален action "rss2_item" (во избежание добавления в ленту левых тегов от плагинов вроде Jetpack).
* при удалении плагина настройки плагина теперь будут полностью удалены из базы данных.
* при деактивации плагина RSS-ленты плагина теперь будут выдавать обычную 404-ошибку.
* исправлены тормоза в админке, если установлено слишком большое общее количество записей в RSS-ленте. 

= 1.03 =
* добавлен третий рекламный блок и возможность выводить рекламу в середине записи.
* добавлена возможность отключения turbo-страниц (путем добавления turbo=&quot;false&quot; к тегу &lt;item>).
* включение рекламных блоков больше не работает, если не указаны идентификаторы рекламных сетей.
* добавлена возможность выводить блок "похожих" записей (тег &lt;yandex:related>).
* исправлено сохранение пустого значения счетчика метрики (чтобы удалить номер установленного счетчика).
* на странице настроек плагина теперь не выводится больше 12 ссылок на RSS-ленты.
* скрипты из кода плагина были перенесены во внешний файл (внутреннее изменение).

= 1.02 =
* добавлена возможность изменения имени ленты в урле.
* функция wpautop теперь обрабатывает контент после удаления тегов, а не до.
* переписана функция удаления тегов без контента (теперь она справляется с большой вложенностью). 

= 1.01 =
* миниатюра в заголовке записи теперь выводится только, если включена соответствующая опция в настройках (проверьте настройки!). 
* из разметки изображений убраны атрибуты srcset и sizes.
* исправлена ошибка парсинга изображений (когда пропадал весь текст записи).

= 1.00 =
* первая версия.
